@model Lustrious.Models.Carrinho
@{
 ViewData["Title"] = "Carrinho";
}
<h2>Carrinho</h2>

<style>
 /* Geral do container do carrinho */
 .cart-container {
 width:90%;
 max-width:1150px;
 margin:32px auto 80px;
 background:#fff6c6;
 border:4px solid #d6b36a;
 border-radius:14px;
 padding:28px; /* mais espaçamento interno */
 box-shadow:10px 24px rgba(0,0,0,0.06);
 min-height:220px;
 }

 /* Estrutura: área principal (tabela) + painel lateral (resumo) */
 .cart-content {
 display:flex;
 gap:32px; /* espaçamento maior entre área principal e resumo */
 align-items:flex-start;
 }

 .cart-main { flex:1; }
 .cart-side { width:340px; }

 .cart-table {
 width:100%;
 border-collapse:collapse;
 background: transparent;
 }

 .cart-table thead th {
 text-align:left;
 padding:20px 14px; /* cabeçalho mais alto */
 border-bottom:2px solid #d6b36a;
 background:#efe2ac;
 color:#4b4b4b;
 font-weight:700;
 }

 .cart-table tbody tr { transition: background .12s ease; }
 .cart-table tbody tr:hover { background: rgba(214,179,106,0.08); }

 .cart-table td {
 padding:20px 14px; /* linhas mais arejadas */
 vertical-align:middle;
 border-bottom:1px solid rgba(0,0,0,0.04);
 }

 .cart-table img { max-width:110px; max-height:110px; border-radius:8px; border:2px solid #e6d6a8; margin-right:8px; }

 /* Zebra leve nas linhas */
 .cart-table tbody tr:nth-child(odd) { background: rgba(255,255,255,0.6); }

 /* Quantidade - controles mais agradáveis */
 .input-group { display:flex; align-items:center; gap:12px; }
 .input-group .btn { border-radius:8px; padding:8px 12px; min-width:36px; }
 .input-group span { min-width:32px; text-align:center; display:inline-block; font-weight:600; }
 /* Force forms inside input-group to be inline-flex so buttons sit side-by-side */
 .input-group form { display:inline-flex; align-items:center; margin:0; padding:0; }
 .input-group .btn-sm { padding:6px 10px; min-width:34px; }

 /* Painel lateral com resumo */
 .cart-side .summary-box {
 background: #fffef2;
 border:2px solid #e6d6a8;
 padding:22px; /* mais espaçamento */
 border-radius:12px;
 }

 .cart-side .summary-box h4 { margin-top:0; color:#3c6b2a; }
 .cart-side .summary-row { display:flex; justify-content:space-between; padding:6px0; }

 /* Botões temáticos */
 .btn-danger { background:#b54845; border-color:#a33d3b; color:#fff; padding:12px 18px; }
 .btn-success { background:#3c6b2a; border-color:#33561f; color:#fff; padding:12px 18px; }
 .btn { border-radius:10px; padding:10px 14px; font-size:15px; }

 /* Empty state */
 .empty-cart {
 width:90%; max-width:700px; margin:40px auto; padding:36px; text-align:center;
 background:#fff6c6; border:4px solid #d6b36a; border-radius:12px;
 box-shadow:08px 18px rgba(0,0,0,0.04);
 }

 /* Mobile: empilhar conteúdo */
 @@media (max-width:900px) {
 .cart-content { flex-direction:column; }
 .cart-side { width:100%; }
 .cart-table thead th { padding:12px8px; }
 .cart-table td { padding:12px8px; }
 }
 </style>

@if (Model == null || Model.Items == null || !Model.Items.Any())
{
 <div class="empty-cart">
 <h3>Carrinho vazio.</h3>
 <p>Você ainda não adicionou produtos ao carrinho.</p>
 <p><a asp-controller="Produto" asp-action="Vitrine">Ver produtos</a></p>
 </div>
}
else
{
 <div class="cart-container">
 <div class="cart-content">
 <div class="cart-main">
 <table class="cart-table">
 <thead>
 <tr>
 <th>Imagem</th>
 <th>Produto</th>
 <th>Código de Barras</th>
 <th>Quantidade</th>
 <th>Valor Unit.</th>
 <th>Subtotal</th>
 <th></th>
 </tr>
 </thead>
 <tbody>
 @foreach (var item in Model.Items)
 {
 <tr>
 <td>
 @if (!string.IsNullOrEmpty(item.Imagem))
 {
 <img src="@item.Imagem" alt="@item.Nome" style="max-width:80px; max-height:80px" />
 }
 </td>
 <td>@item.Nome</td>
 <td>@item.CodigoBarras</td>
 <td>
 <div class="input-group" style="max-width:150px">
 <form asp-action="DecrementarItem" method="post">
 @Html.AntiForgeryToken()
 <input type="hidden" name="produtoId" value="@item.ProdutoId" />
 <button type="submit" class="btn btn-sm btn-outline-secondary">-</button>
 </form>
 <span class="mx-2 align-middle">@item.Qtd</span>
 <form asp-action="IncrementarItem" method="post">
 @Html.AntiForgeryToken()
 <input type="hidden" name="produtoId" value="@item.ProdutoId" />
 <button type="submit" class="btn btn-sm btn-outline-secondary">+</button>
 </form>
 </div>
 </td>
 <td>@item.ValorItem.ToString("C")</td>
 <td>R$ @(item.ValorItem * item.Qtd)</td>
 <td>
 <form asp-action="RemoverItem" method="post">
 @Html.AntiForgeryToken()
 <input type="hidden" name="produtoId" value="@item.ProdutoId" />
 <button type="submit" class="btn btn-sm btn-danger">Remover</button>
 </form>
 </td>
 </tr>
 }
 </tbody>
 </table>
 </div>

 <aside class="cart-side">
 <div class="summary-box">
 <h4>Resumo do pedido</h4>
 <div class="summary-row"><span>Total de itens:</span><strong>@Model.Qtd</strong></div>
 <div class="summary-row"><span>Valor total:</span><strong>@Model.ValorTotal.ToString("C")</strong></div>
 <hr />
 <form asp-action="RemoverTodosItens" method="post">
 @Html.AntiForgeryToken()
 <button type="submit" class="btn btn-danger" style="width:100%">Limpar Carrinho</button>
 </form>
 <form asp-action="Checkout" method="post" style="margin-top:12px;">
 @Html.AntiForgeryToken()
 <label for="idEnd">Endereço (id):</label>
 <input type="number" id="idEnd" name="idEnd" value="0" style="width:100%; margin-top:8px; padding:8px; box-sizing:border-box;" />
 <button type="submit" class="btn btn-success" style="width:100%; margin-top:12px;">Finalizar Compra</button>
 </form>
 </div>
 </aside>

 </div> <!-- cart-content -->

 </div> <!-- cart-container -->
}

<p style="margin-left:10%;"><a href="/">Voltar</a></p>

@section Scripts {
 @* No AJAX script: server will handle redirect after Checkout *@
}